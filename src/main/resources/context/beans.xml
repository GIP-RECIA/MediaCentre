<beans
        xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:context="http://www.springframework.org/schema/context" xmlns:p="http://www.springframework.org/schema/p"
        xmlns:util="http://www.springframework.org/schema/util"
        xsi:schemaLocation=
                "http://www.springframework.org/schema/beans
                http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
                http://www.springframework.org/schema/context
                http://www.springframework.org/schema/context/spring-context-3.2.xsd
                http://www.springframework.org/schema/util
                https://www.springframework.org/schema/util/spring-util.xsd"
>
    <context:annotation-config/>

    <!-- UserResource -->
    <bean id="userResource" class="org.esco.portlet.mediacentre.dao.impl.UserResourceImpl"/>
    <!--<bean id="userResource" class="org.esco.portlet.mediacentre.dao.impl.MockUserResourceImpl"/>-->

    <!-- PreferenceResource -->
    <bean id="preferenceResource" class="org.esco.portlet.mediacentre.dao.impl.PreferenceResourceImpl"/>
    <!--<bean id="preferenceResource" class="org.esco.portlet.mediacentre.dao.impl.MockPreferenceResourceImpl"/>-->

    <!-- MediacentreRessource -->
    <bean id="mediacentreRessource" class="org.esco.portlet.mediacentre.dao.impl.MediaCentreResourceJacksonImpl"/>

    <!-- JsonHttpMessageConverter -->
    <bean id="jsonHttpMessageConverter" class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter">
        <property name="supportedMediaTypes">
            <list>
                <value>application/json</value>
                <value>application/octet-stream</value>
                <value>text/plain;charset=UTF-8</value>
            </list>
        </property>
    </bean>

    <!-- HttpClientBuilder -->
    <bean id="httpClientBuilder" class="org.apache.http.impl.client.HttpClientBuilder" factory-method="create"/>

    <!-- HttpClient -->
    <bean name="httpClient" factory-bean="httpClientBuilder" factory-method="build"/>

    <!-- RestTemplate -->
    <bean id="restTemplate" class="org.springframework.web.client.RestTemplate">
        <constructor-arg>
            <bean
                    class="org.springframework.http.client.HttpComponentsClientHttpRequestFactory"
                    p:readTimeout="15000"
                    p:connectTimeout="5000"
                    p:connectionRequestTimeout="5000"
            >
                <property name="httpClient" ref="httpClient"/>
            </bean>
        </constructor-arg>
        <property name="messageConverters">
            <list>
                <ref bean="jsonHttpMessageConverter"/>
            </list>
        </property>
    </bean>

    <!-- EhCache -->
    <bean id="ehcache" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean">
        <property name="configLocation" value="classpath:ehcache.xml"/>
        <property name="shared" value="true"/>
    </bean>

    <!-- CategoriesFiltres -->
    <util:list id="categoriesFiltres" value-type="org.esco.portlet.mediacentre.model.filtres.CategorieFiltres">
        <bean class="org.esco.portlet.mediacentre.model.filtres.CategorieFiltresEtablissement">
            <property name="id" value="etablissements"/>
            <property name="libelle" value="filter.establishments"/>
            <property name="libelleTous" value="filter.establishments.all"/>
            <property name="nomAttributFiltre" value="idEtablissement.id"/>
            <property name="attributUtilisateurDefaut" value="ESCOSIRENCourant"/>
            <property name="valeursMultiples" value="false"/>
            <property name="defaultEmptyValue" value="Indéterminé"/>
            <property name="population" value="ENTPersonProfils"/>
            <property name="regexpPopulation" value="((National_ENS)|(National_DOC)|(National_EVS))"/>
        </bean>

        <bean class="org.esco.portlet.mediacentre.model.filtres.CategorieFiltres">
            <property name="id" value="ressources"/>
            <property name="libelle" value="filter.resources"/>
            <property name="valeursMultiples" value="false"/>
            <property name="defaultEmptyValue" value="Indéterminé"/>
            <property name="population" value=""/>
            <property name="regexpPopulation" value=""/>
            <property name="filtres">
                <list>
                    <bean class="org.esco.portlet.mediacentre.model.filtres.Filtre">
                        <property name="id" value="filter.resources"/>
                        <property name="libelle" value="filter.resources.all"/>
                        <property name="actif" value="true"/>
                        <property name="defaultEmptyValue" value="Indéterminé"/>
                        <property name="nomAttribut" value="idRessource"/>
                        <property name="regexpAttribut" value=".*"/>
                        <property name="population" value=""/>
                        <property name="regexpPopulation" value=""/>
                    </bean>
                    <bean class="org.esco.portlet.mediacentre.model.filtres.FiltreFavoris">
                        <property name="libelle" value="filter.resources.favoris"/>
                        <property name="actif" value="false"/>
                        <property name="defaultEmptyValue" value="Indéterminé"/>
                        <property name="population" value=""/>
                        <property name="regexpPopulation" value=""/>
                    </bean>
                </list>
            </property>
        </bean>

        <bean class="org.esco.portlet.mediacentre.model.filtres.CategorieFiltresRessource">
            <property name="id" value="niveauEducatif"/>
            <property name="libelle" value="filter.level"/>
            <property name="libelleTous" value="filter.level.all"/>
            <property name="nomAttributFiltre" value="niveauEducatif.nom"/>
            <property name="valeursMultiples" value="true"/>
            <property name="defaultEmptyValue" value="Indéterminé"/>
            <property name="population" value="ENTPersonProfils"/>
            <property name="regexpPopulation" value="((National_ENS)|(National_DOC)|(National_EVS))"/>
        </bean>

        <bean class="org.esco.portlet.mediacentre.model.filtres.CategorieFiltresRessource">
            <property name="id" value="typeMedia"/>
            <property name="libelle" value="filter.type"/>
            <property name="libelleTous" value="filter.type.all"/>
            <property name="nomAttributFiltre" value="typePresentation.nom"/>
            <property name="valeursMultiples" value="true"/>
            <property name="defaultEmptyValue" value="Indéterminé"/>
            <property name="population" value=""/>
            <property name="regexpPopulation" value=""/>
        </bean>

        <bean class="org.esco.portlet.mediacentre.model.filtres.CategorieFiltresRessource">
            <property name="id" value="discipline"/>
            <property name="libelle" value="filter.subject"/>
            <property name="libelleTous" value="filter.subject.all"/>
            <property name="nomAttributFiltre" value="domaineEnseignement.nom"/>
            <property name="valeursMultiples" value="true"/>
            <property name="defaultEmptyValue" value="Indéterminé"/>
            <property name="population" value="ENTPersonProfils"/>
            <property name="regexpPopulation" value="National_ELV"/>
        </bean>
    </util:list>

    <!-- GestionAffectation -->
    <util:list id="gestionAffectation" value-type="org.esco.portlet.mediacentre.model.affectation.GestionAffectation">
        <bean class="org.esco.portlet.mediacentre.model.affectation.GestionAffectation">
            <property name="id" value="GAR"/>
            <property name="nom" value="site.affectation.nom.GAR"/>
            <property name="description" value="site.affectation.description.GAR"/>
            <property name="lien" value="https://maquette-lycees.netocentre.fr/idp/profile/SAML2/Unsolicited/SSO?providerId=urn:gar:ihmAffectation:seclin&amp;target=https://affectation.partenaire.test-gar.education.fr"/>
            <property name="population" value="isMemberOf"/>
            <property name="regexpPopulation" value="((esco)|(clg37)):admin:mediacentre:GAR:RESPONSABLE_AFFECTATION:.+"/>
        </bean>
    </util:list>
</beans>
